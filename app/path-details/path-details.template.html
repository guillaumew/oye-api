<link rel="stylesheet" type="text/css" href="styles/objects.css">
<style type="text/css">
.map-container{
    width: 100%;
    display: block;
    position: fixed;
    bottom:90px;
    top:180px;
}
.angular-google-map,.angular-google-map-container { height: 100%; }

</style></strong>

<div class="page-title">
	<H1>{{$ctrl.response.path.name}}</H1>
</div>
<div>
	<p ng-click="$ctrl.deleteProgress()">Supprimer la progression</p>
	<img ng-if="$ctrl.response.is_editable" ng-src="https://cdn3.iconfinder.com/data/icons/flat-circle-content/512/flat-style-circle-add-2-64.png" ng-click="$ctrl.addPlace()" style="float:right;">
</div>
<div class="map-container">
	<ui-gmap-google-map center="map.center" zoom='map.zoom'>
		<ui-gmap-markers models="markers" coords="'self'" icon="'icon'", click="click"></ui-gmap-markers>
	</ui-gmap-google-map>
</div>

<div class="content" ng-if="$ctrl.current_content.is_shown">
	<div class="flip_content" ng-click="$ctrl.flipContent()" ng-if="$ctrl.current_content.is_succeeded"></div>
	<div class="close_content" ng-click="$ctrl.closeContent()"></div>
	<section id="content_container">
		<div id="card">
			<figure class="front">
				<h3>{{$ctrl.current_content.name}}</h3>
				<div ng-bind-html="$ctrl.current_content.init_content.description | trusted"></div>
				<div class="media_content">
					<img ng-src="{{$ctrl.current_content.init_content.media.url}}" ng-if="$ctrl.current_content.init_content.media_type == 'img'">

					<div ng-if="$ctrl.current_content.init_content.media_type == 'group'" class="subobjects">
						<div ng-repeat="subobject in $ctrl.current_content.init_content.sub_obj" ng-click="$ctrl.showContent(subobject)" class="object">
							<img ng-src="{{subobject.thumb.url}}">
							<span class="object_title">{{subobject.name}}</span>
						</div>
					</div>
				</div>
				
				<div id="media_password" ng-if="$ctrl.current_content.success_condition == 'password'">
					<p>Tu as trouvé la solution ?</p>
					<p style="padding-left: 1px;text-align: center;" id="password_input">
						<input type="text" ng-model="$ctrl.current_content.user_password">
						<input type="submit" value="Envoyer" ng-click="$ctrl.testPassword()">
					</p>
				</div>

				<div ng-if="$ctrl.response.is_editable" ng-click="$ctrl.editItem($ctrl.current_content.source)">Modifier cet élément</div>
			</figure>
			<figure class = "back">
				<h3>{{$ctrl.current_content.name}}</h3>
				<div ng-bind-html="$ctrl.current_content.success_content.description | trusted"></div>
				<div class="media_content">
					<img ng-src="{{$ctrl.current_content.success_content.media.url}}" ng-if="$ctrl.current_content.success_content.media_type == 'img'">
				</div>
				<div></div>
			</figure>
		</div>
	</section>
</div>

<div id="objects">
	<div id="objects_title">Objets</div>
	<div id="objects_container">
		<div id="objects_list">
			<div class="object" ng-repeat="object in $ctrl.response.objects | filter: {is_visible: 'true'}" ng-click="$ctrl.showContent(object)">
				<img ng-src="{{object.thumb.url}}">
				<span class="object_title">{{object.name}}</span>
			</div>
			<div class="object" ng-if="$ctrl.response.is_editable" ng-click="$ctrl.addObject()">
				<img ng-src="https://cdn3.iconfinder.com/data/icons/flat-circle-content/512/flat-style-circle-add-2-128.png">
			</div>
		</div>
	</div>
</div>

<style type="text/css">
@keyframes shake {
  0% {transform: translateX(0);}
  12.5% {transform: translateX(-10px) rotateY(-5deg)}
  37.5% {transform: translateX(5px) rotateY(4deg)}
  62.5% {transform: translateX(-3px) rotateY(-2deg)}
  87.5% {transform: translateX(2px) rotateY(1deg)}
  100% {transform: translateX(0)}
}

@-webkit-keyframes shake {
  0% {-webkit-transform: translateX(0);}
  12.5% {-webkit-transform: translateX(-10px) rotateY(-5deg)}
  37.5% {-webkit-transform: translateX(5px) rotateY(4deg)}
  62.5% {-webkit-transform: translateX(-3px) rotateY(-2deg)}
  87.5% {-webkit-transform: translateX(2px) rotateY(1deg)}
  100% {-webkit-transform: translateX(0)}
}
#password_input{
	left: 5%;
    position: relative;
}

.shake {
  -webkit-animation: shake 400ms ease-in-out;
  animation: shake 400ms ease-in-out;
}

figure img{
	width:100%;
}
.subobjects{
	text-align: center;
	display: inline-block;
}
.flip_content{
	position: absolute;
	left:0;
    background: grey;
    height: 30px;
    width: 30px;
    z-index: 100;
}
.close_content{
	position: absolute;
	right:0;
    background: black;
    height: 30px;
    width: 30px;
    z-index: 100;
}
.content{
    position: fixed;
    left: 5px;
    right: 5px;
    bottom: 95px;
    top: 70px;
}
#content_container {
	transition: all 1s;
	width: 100%;
	height: 100%;
	position: relative;
	perspective: 800px;
	padding: 0;
	overflow-y: scroll;
  border: solid 2px #121326;
  background: white;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}
#card {
  width: 100%;
  height: 100%;
  position: absolute;
  transform-style: preserve-3d;
  transition: transform 1s;
  background: white;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}
#card figure {
  margin: 0;
  display: block;
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  background: white;
  
}
#card .back {
	transform: rotateY( 180deg );
}
#card.flipped {
  transform: rotateY( 180deg );
}
</style>